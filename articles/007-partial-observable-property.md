---
title: "Partial Observable Property"
emoji: "ğŸ§©"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["WinUI", "WinUI3", "WindowsAppSDK", "XAML", "MVVM"]
published: true
---

https://youtu.be/Tu7asErZc54?si=zdzp2qJMQrceQkV0

.NET 9ã®ãƒªãƒªãƒ¼ã‚¹ã«[éƒ¨åˆ†ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£](https://learn.microsoft.com/ja-jp/dotnet/csharp/language-reference/keywords/partial-member?wt.mc_id=MVP_356303)ãŒç››ã‚Šè¾¼ã¾ã‚Œã€æ—©é€Ÿ[CommunityToolkit.Mvvm](https://learn.microsoft.com/ja-jp/dotnet/communitytoolkit/mvvm/?wt.mc_id=MVP_356303)NuGetãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®v8.4.0-preview2ã‚‚ãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã¾ã—ãŸã€‚

ã“ã‚Œã«ã‚ˆã‚Šã€éƒ¨åˆ†ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’æ´»ç”¨ã—ãŸ[ObservableProperty](https://learn.microsoft.com/en-us/dotnet/communitytoolkit/mvvm/generators/observableproperty?wt.mc_id=MVP_356303)ãŒä½¿ãˆã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚

:::message
**CommunityToolkit.Mvvmé–¢é€£è¨˜äº‹**
- [WinUI x CommunityToolkit.Mvvm [ObservableObjectãƒ»ObservablePropertyç·¨]](https://zenn.dev/andrewkeepcodin/articles/003-community-toolkit-mvvm-observable-property)
- [WinUI x CommunityToolkit.Mvvm [RelayCommandç·¨]](https://zenn.dev/andrewkeepcodin/articles/004-community-toolkit-mvvm-relay-command)
:::

å…·ä½“çš„ã«ã¯ã€
ã“ã‚Œã¾ã§ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«è‡ªåˆ†ã§`ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰`ã‚’æ›¸ãã€ã‚½ãƒ¼ã‚¹ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼ã«ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’æ›¸ã„ã¦ã‚‚ã‚‰ã£ã¦ã¾ã—ãŸãŒ...

```cs
using CommunityToolkit.Mvvm.ComponentModel;
using Microsoft.UI.Xaml.Controls;

namespace CommunityToolkitMvvmPartialProperty;

public partial class SomeViewModel : ObservableObject
{
    [ObservableProperty]
    private string? _someText;
}
```

:::details ç”Ÿæˆã‚³ãƒ¼ãƒ‰
:::message
```cs
// <auto-generated/>
#pragma warning disable
#nullable enable
namespace CommunityToolkitMvvmPartialProperty
{
    /// <inheritdoc/>
    partial class SomeViewModel
    {
        /// <inheritdoc cref="_someText"/>
        [global::System.CodeDom.Compiler.GeneratedCode("CommunityToolkit.Mvvm.SourceGenerators.ObservablePropertyGenerator", "8.4.0.0")]
        [global::System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverage]
        public string? SomeText
        {
            get => _someText;
            set
            {
                if (!global::System.Collections.Generic.EqualityComparer<string?>.Default.Equals(_someText, value))
                {
                    OnSomeTextChanging(value);
                    OnSomeTextChanging(default, value);
                    OnPropertyChanging(global::CommunityToolkit.Mvvm.ComponentModel.__Internals.__KnownINotifyPropertyChangingArgs.SomeText);
                    _someText = value;
                    OnSomeTextChanged(value);
                    OnSomeTextChanged(default, value);
                    OnPropertyChanged(global::CommunityToolkit.Mvvm.ComponentModel.__Internals.__KnownINotifyPropertyChangedArgs.SomeText);
                }
            }
        }

        /// <summary>Executes the logic for when <see cref="SomeText"/> is changing.</summary>
        /// <param name="value">The new property value being set.</param>
        /// <remarks>This method is invoked right before the value of <see cref="SomeText"/> is changed.</remarks>
        [global::System.CodeDom.Compiler.GeneratedCode("CommunityToolkit.Mvvm.SourceGenerators.ObservablePropertyGenerator", "8.4.0.0")]
        partial void OnSomeTextChanging(string? value);
        /// <summary>Executes the logic for when <see cref="SomeText"/> is changing.</summary>
        /// <param name="oldValue">The previous property value that is being replaced.</param>
        /// <param name="newValue">The new property value being set.</param>
        /// <remarks>This method is invoked right before the value of <see cref="SomeText"/> is changed.</remarks>
        [global::System.CodeDom.Compiler.GeneratedCode("CommunityToolkit.Mvvm.SourceGenerators.ObservablePropertyGenerator", "8.4.0.0")]
        partial void OnSomeTextChanging(string? oldValue, string? newValue);
        /// <summary>Executes the logic for when <see cref="SomeText"/> just changed.</summary>
        /// <param name="value">The new property value that was set.</param>
        /// <remarks>This method is invoked right after the value of <see cref="SomeText"/> is changed.</remarks>
        [global::System.CodeDom.Compiler.GeneratedCode("CommunityToolkit.Mvvm.SourceGenerators.ObservablePropertyGenerator", "8.4.0.0")]
        partial void OnSomeTextChanged(string? value);
        /// <summary>Executes the logic for when <see cref="SomeText"/> just changed.</summary>
        /// <param name="oldValue">The previous property value that was replaced.</param>
        /// <param name="newValue">The new property value that was set.</param>
        /// <remarks>This method is invoked right after the value of <see cref="SomeText"/> is changed.</remarks>
        [global::System.CodeDom.Compiler.GeneratedCode("CommunityToolkit.Mvvm.SourceGenerators.ObservablePropertyGenerator", "8.4.0.0")]
        partial void OnSomeTextChanged(string? oldValue, string? newValue);
    }
}
```
:::

v8.4.0-preview2ã§ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ã«è‡ªåˆ†ã§`éƒ¨åˆ†ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£`ã‚’æ›¸ãã€ã‚½ãƒ¼ã‚¹ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼ã«å®Ÿè£…ã‚’æ›¸ã„ã¦ã‚‚ã‚‰ãˆã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚

```cs
using CommunityToolkit.Mvvm.ComponentModel;
using Microsoft.UI.Xaml.Controls;

namespace CommunityToolkitMvvmPartialProperty;

public partial class SomeViewModel : ObservableObject
{
    [ObservableProperty]
    public partial string? SomeText { get; set; }
}
```

:::details ç”Ÿæˆã‚³ãƒ¼ãƒ‰
:::message
```cs
// <auto-generated/>
#pragma warning disable
#nullable enable
namespace CommunityToolkitMvvmPartialProperty
{
    /// <inheritdoc/>
    partial class SomeViewModel
    {
        /// <inheritdoc/>
        [global::System.CodeDom.Compiler.GeneratedCode("CommunityToolkit.Mvvm.SourceGenerators.ObservablePropertyGenerator", "8.4.0.0")]
        [global::System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverage]
        public partial string? SomeText
        {
            get => field;
            set
            {
                if (!global::System.Collections.Generic.EqualityComparer<string?>.Default.Equals(field, value))
                {
                    OnSomeTextChanging(value);
                    OnSomeTextChanging(default, value);
                    OnPropertyChanging(global::CommunityToolkit.Mvvm.ComponentModel.__Internals.__KnownINotifyPropertyChangingArgs.SomeText);
                    field = value;
                    OnSomeTextChanged(value);
                    OnSomeTextChanged(default, value);
                    OnPropertyChanged(global::CommunityToolkit.Mvvm.ComponentModel.__Internals.__KnownINotifyPropertyChangedArgs.SomeText);
                }
            }
        }

        /// <summary>Executes the logic for when <see cref="SomeText"/> is changing.</summary>
        /// <param name="value">The new property value being set.</param>
        /// <remarks>This method is invoked right before the value of <see cref="SomeText"/> is changed.</remarks>
        [global::System.CodeDom.Compiler.GeneratedCode("CommunityToolkit.Mvvm.SourceGenerators.ObservablePropertyGenerator", "8.4.0.0")]
        partial void OnSomeTextChanging(string? value);
        /// <summary>Executes the logic for when <see cref="SomeText"/> is changing.</summary>
        /// <param name="oldValue">The previous property value that is being replaced.</param>
        /// <param name="newValue">The new property value being set.</param>
        /// <remarks>This method is invoked right before the value of <see cref="SomeText"/> is changed.</remarks>
        [global::System.CodeDom.Compiler.GeneratedCode("CommunityToolkit.Mvvm.SourceGenerators.ObservablePropertyGenerator", "8.4.0.0")]
        partial void OnSomeTextChanging(string? oldValue, string? newValue);
        /// <summary>Executes the logic for when <see cref="SomeText"/> just changed.</summary>
        /// <param name="value">The new property value that was set.</param>
        /// <remarks>This method is invoked right after the value of <see cref="SomeText"/> is changed.</remarks>
        [global::System.CodeDom.Compiler.GeneratedCode("CommunityToolkit.Mvvm.SourceGenerators.ObservablePropertyGenerator", "8.4.0.0")]
        partial void OnSomeTextChanged(string? value);
        /// <summary>Executes the logic for when <see cref="SomeText"/> just changed.</summary>
        /// <param name="oldValue">The previous property value that was replaced.</param>
        /// <param name="newValue">The new property value that was set.</param>
        /// <remarks>This method is invoked right after the value of <see cref="SomeText"/> is changed.</remarks>
        [global::System.CodeDom.Compiler.GeneratedCode("CommunityToolkit.Mvvm.SourceGenerators.ObservablePropertyGenerator", "8.4.0.0")]
        partial void OnSomeTextChanged(string? oldValue, string? newValue);
    }
}
```
:::

ãƒ¡ãƒªãƒƒãƒˆã¨ã—ã¦ã¯ã€
- `ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰`(`_someText`)ã§ã¯ãªãã€XAMLã§å®Ÿéš›ã«ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã™ã‚‹`ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£`(`SomeText`)ã‚’æ›¸ãã®ã§ã‚³ãƒ¼ãƒ‰ãŒã‚ˆã‚Šç›´è¦³çš„ã«ãªã£ãŸ
- ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£åã§æ¤œç´¢ã—ã‚„ã™ããªã£ãŸ
- ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®setterã‚’`private`ã«ã§ãã‚‹(`TwoWay`ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã‚’ã§ããªãã™ã‚‹)
  ```cs
  public partial string? SomeText { get; private set; }
  ```

ãƒ‡ãƒ¡ãƒªãƒƒãƒˆã¨ã—ã¦ã¯ã€
...ä»Šã®ã¨ã“ã‚ã¯æ€ã„ã¤ãã¾ã›ã‚“ã€‚

:::message alert
v8.4.0-preview2ã®ç”Ÿæˆã‚³ãƒ¼ãƒ‰ã§ç¢ºèªã§ãã¾ã™ãŒã€`field`ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãŒä½¿ç”¨ã•ã‚Œã¦ã„ã¾ã™ã€‚
`field`ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã¯ã¾ã ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ©Ÿèƒ½ã§ã‚ã‚‹ãŸã‚ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã§è¨€èªãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’`preview`ã«è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
```xml
<PropertyGroup>
  <LangVersion>preview</LangVersion>
</PropertyGroup>
```
:::

ä»Šå›ã¯ä»¥ä¸Šã§ã™ã€‚

Happy Coding!ğŸ˜Š
